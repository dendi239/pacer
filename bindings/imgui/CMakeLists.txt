litgen_find_nanobind()

add_custom_target(
    _generate_imgui_bindings
    COMMAND "${Python_EXECUTABLE}" "${CMAKE_CURRENT_SOURCE_DIR}/generate-bindings.py"
    COMMENT "Building pacer python bindings"
)

# The python module sources
set(python_module_sources
    module.cpp                # The python module entry point
    nanobind_imgui.cpp        # The pybind11 bindings to the library, which are mainly auto-generated by litgen
)

nanobind_add_module(_imgui ${python_module_sources})

if (SKBUILD)
  set(LITGEN_PATH_IMGUI "${CMAKE_INSTALL_PREFIX}" CACHE PATH "Path to install the imgui python module")
else()
  set(LITGEN_PATH_IMGUI  "${CMAKE_SOURCE_DIR}/bindings/imgui" CACHE PATH "Path to install the imgui python module")
endif()

# Call litgen_setup_module to generate the python wrapper around the native module
litgen_setup_module(
    # The C++ library for which we are building bindings
    imgui
    # The native python module name
    _imgui
    # This is the python wrapper around the native module
    imgui
    # The path where the python module will be copied after build (for editable mode)
    "${LITGEN_PATH_IMGUI}"
)

add_dependencies(
    _imgui
    _generate_imgui_bindings
)
